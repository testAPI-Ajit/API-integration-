delete from pricing_tool.i_tpt_custrtd where ctid in (
select ctid from (SELECT ctid, ROW_NUMBER() OVER (PARTITION BY
 aedat , aenam, aezet , approval_ref ,begda,change_ref,
  destcluster,dist_h,dist_hh,dist_p,endda,erdat,ernam,erzet,fdz_ind,
	geo_rtd,kunwe,levi_oneway,levi_twoway,mandt,rtdstatus,ship_state,
	shpt_bottom_load,shpt_state,vehcap_ind,vstel
  ORDER BY mandt) cnt
FROM pricing_tool.i_tpt_custrtd ) table1 where cnt>1)


delete from pricing_tool.i_tpt_custrtd_i_bukrs where ctid in (
select ctid from (SELECT ctid, ROW_NUMBER() OVER (PARTITION BY
bukrs,mandt,tplst_high,tplst_low,tplst_option,tplst_sign,high,low,option,sign order by mandt) cnt
				  FROM pricing_tool.i_tpt_custrtd_i_bukrs ) table1 where cnt>1)

delete from pricing_tool.i_tpt_custrtd_i_werks where ctid in (
select ctid from (select ctid,ROW_NUMBER() OVER (PARTITION BY
mandt,werks order by mandt)cnt from pricing_tool.i_tpt_custrtd_i_werks) table1
where cnt>1)

delete from pricing_tool.yv_et_cfarates where ctid in (
select ctid from (select ctid,ROW_NUMBER() OVER (PARTITION BY
aedat,aenam,aezet,erdat,ernam,erzet,mandt,outsidestate,rateuom,remarks,slab_from_km,
	slab_to_km,vstel,yytenderno	order by id desc)cnt from pricing_tool.yv_et_cfarates) table1
where cnt>1)

delete from pricing_tool.yv_et_cfacont where ctid in (
select ctid from (select ctid,ROW_NUMBER() OVER (PARTITION BY
aedat,aenam,aezet,end_date,erdat,ernam,erzet,extn_dt1,extn_dt2,extn_dt3
,extn_ref1,extn_ref2,extn_ref3,fixed_charges,handling_rate,hsd_basedate,
hsd_baserate,mandt,remarks,start_date, trans_uom,vstel,yytenderno,yyvendor order by id desc)cnt from pricing_tool.yv_et_cfacont) table1
where cnt>1)

delete from pricing_tool.yv_contract_rates_o_report where ctid in (
select ctid from (select ctid,ROW_NUMBER() OVER (PARTITION BY
bukrs,capcluster,cap_desc,destcluster,dest_desc,final_uom,final_uomkm,
	kunwe,matkl,name1,name2,rateapp_desc,remarks,rtdcluster,rtd_desc
,tplst ,vstel,yytenderno  order by id desc)cnt from pricing_tool.yv_contract_rates_o_report) table1
where cnt>1)

delete from pricing_tool.y_lubebom_dnld_e_bom where ctid in (
select ctid from (select ctid,ROW_NUMBER() OVER (PARTITION BY
 comnm,datuv, idnrk,matnr,meins,menge,mtart,posnr,stlal,stlkn,stlnr,stprs,verpr
,werks		 order by werks)cnt from pricing_tool.y_lubebom_dnld_e_bom) table1
where cnt>1)

delete from pricing_tool.ym_po_det_rfc_ho_lubes where ctid in (
select ctid from (select ctid,ROW_NUMBER() OVER (PARTITION BY
aedat,belnr,bsart,bstme,bstyp,buzei,ebeln,ebelp,gjahr,konnr,ktpnr,loekz,matkl,
matnr,meins,menge,mtart,waers,werks, wrbtr order by werks)cnt from pricing_tool.ym_po_det_rfc_ho_lubes) table1
where cnt>1)

delete from pricing_tool.yv_exchg_rate_et_exch_rate where ctid in (
select ctid from (select ctid,ROW_NUMBER() OVER (PARTITION BY
fcurr,ffact,gdatu,kurst,mandt,tcurr,tfact,ukurs order by mandt)cnt from pricing_tool.yv_exchg_rate_et_exch_rate ) table1
where cnt>1)

delete from pricing_tool.yv_material_master_all_views_e_mara where ctid in (
select ctid from (select ctid,ROW_NUMBER() OVER (PARTITION BY
bism,brgew,ersda,ferth,groes,laeda,maktx,matnr,meins,normt,ntgew,tragr,division_code,wrkst order by id desc)cnt from pricing_tool.yv_material_master_all_views_e_mara) table1
where cnt>1)

delete from pricing_tool.yv_material_master_all_views_e_marm where ctid in (
select ctid from (select ctid,ROW_NUMBER() OVER (PARTITION BY
matnr,meinh,meins,seprtr,umren,umrez,mantr,division_code order by id desc)cnt from pricing_tool.yv_material_master_all_views_e_marm) table1
where cnt>1)

delete from pricing_tool.yv_material_master_all_views_e_mvke where ctid in (
select ctid from (select ctid,ROW_NUMBER() OVER (PARTITION BY
dwerk,kondm,kondmt,ktgrm,ktgrmt,matnr,mvgr1,mvgr2,mvgr3,vkorg,vtweg,division_code	order by id desc)cnt from pricing_tool.yv_material_master_all_views_e_mvke) table1
where cnt>1)

delete from pricing_tool.yvb_exchange_rate where ctid in (
select ctid from (select ctid,ROW_NUMBER() OVER (PARTITION BY
fcurr,ffact,gdatu,kurst,mandt,tcurr,tfact,ukurs	order by id desc)cnt from pricing_tool.yvb_exchange_rate) table1
where cnt>1)



delete from pricing_tool.yv_material_master_all_views_e_mbew where ctid in (
select ctid from (select ctid,ROW_NUMBER() OVER (PARTITION BY
bklas,bwkey,matnr,stprs,verpr,vprsv,division_code	order by id desc)cnt from pricing_tool.yv_material_master_all_views_e_mbew) table1
where cnt>1)

delete from pricing_tool.yv_material_master_all_views_e_marc where ctid in (
select ctid from (select ctid,ROW_NUMBER() OVER (PARTITION BY
abfac,matnr,umrsl,uomgr,werks,division_code order by id desc)cnt from pricing_tool.yv_material_master_all_views_e_marc) table1
where cnt>1)

delete from pricing_tool.yv_material_master_all_views_e_marm where ctid in (
select ctid from (select ctid,ROW_NUMBER() OVER (PARTITION BY
matnr,meinh,meins,seprtr,umren,umrez,mantr,division_code order by id desc)cnt from pricing_tool.yv_material_master_all_views_e_marm) table1
where cnt>1)


delete from pricing_tool.yv_lu_pck_rate_et_car_grp where ctid in (
select ctid from (select ctid,ROW_NUMBER() OVER (PARTITION BY
begda,endda,mandt,werks,wgt_from,yycarton_grp,wgt_to,yyrate_percent order by mandt)cnt from pricing_tool.yv_lu_pck_rate_et_car_grp) table1
where cnt>1)

delete from pricing_tool.yv_lu_pck_rate_et_transrate where ctid in (
select ctid from (select ctid,ROW_NUMBER() OVER (PARTITION BY
begda,bzirk,endda,kunnr,mandt,provisional,remarks,tu_number,veh_type,
werks,yybase_rate,yyrate_applic   order by mandt)cnt from pricing_tool.yv_lu_pck_rate_et_transrate) table1
where cnt>1)







LU API resp









Error creating bean with name 'dataSourceScriptDatabaseInitializer': Singleton bean creation not allowed while singletons of this factory are in destruction (Do not request a bean from a BeanFactory in a destroy method implementation!)
